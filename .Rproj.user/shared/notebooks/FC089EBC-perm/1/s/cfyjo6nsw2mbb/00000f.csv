"0","# beta_1 estimated on the observed data:"
"0","beta1=coefficients(lm(Reaction.Time~Age,data=reaction))[2]"
"0",""
"0","# function that permutes the y values and calculates the coeff beta_1"
"0","my.beta.perm <- function(Y,X){"
"0","  model=lm(sample(Y)~X)"
"0","  coefficients(model)[2]"
"0","}"
"0",""
"0","#replicate it B-1 times"
"0","beta.perm= replicate(B,my.beta.perm(reaction$Reaction.Time, reaction$Age ))"
